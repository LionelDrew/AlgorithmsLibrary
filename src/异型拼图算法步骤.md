## 名词解释

大板：用来拼入零件的外围板，支持异型

零件：拼入到大板中的小图形

计算精度：即马赛克大小，计算中会将大板和零件都切割成矩形来计算，这个参数用来设置这些矩形的大小。此值越大则计算越粗略，计算速度越快，越小则计算越慢，计算精度越高

候选区：根据计算进度切割大板得出的小矩形列表，每拼入一个零件后此小矩形列表都会更新

计算候选区：区别于候选区，候选区是根据计算精度划分出的最小的矩形，但实际计算时不能使用这些最小的矩形来计算零件的位置，因为如果直接使用这些最小矩形来计算，会导致计算巨慢，而且会有巨量的重复计算，所以实际计算零件位置时，会先将这些小的候选区合并为一个大矩形，然后在这个大矩形中放入零件，这样就可以避免海量的重复计算，大幅提高计算速度，而这些由候选区合并成的大矩形，就是计算候选区

## 异型拼图算法思路

此算法为在一个大的异型图形中拼入小的异型图形，而异型图形难以计算，所以此算法的大体思路就是将异型的大板和零件都转换成由小矩形组成的结合体，使用矩形就能方便的计算。具体的为：将大板划分为小矩形即候选区，然后拼入零件，拼入一个零件后就将与这个零件相交的候选区删除，然后在剩下的候选区中继续拼入下一个零件

## 步骤一.初始化参数

### 1.初始化大板

根据给进的边距，将大板缩小，然后根据计算精度将板材划分为小矩形。此后根据这些小矩形计算出计算候选区，拼图时就在计算候选区中拼入零件

### 2.初始化零件

求出零件的最小包络矩形，需注意零件的最小包络矩形为零件旋转后所在矩形的面积最小的矩形，然后将零件按照包络矩形的周长降序排列

## 步骤二.执行套料算法

Step1 : 判断大板是否还有剩余，如果没有则算法结束，否则取出剩余大板列表中的第一个大板，放入剩余零件列表中的第一个零件，具体放入方式为：遍历计算候选区，分别计算在每个计算候选区中的适应度，然后取适应度最高的结果为拼入结果。此处需注意并不是每个计算候选区都要计算，有两种计算候选区不做计算：1.同种零件同种角度下，如果之前已经计算过此计算候选区无效，则后续就不再次使用此计算候选区。2.如果一个计算候选区明显不如另外的计算候选区，则放弃此计算候选区，具体为：如果一个计算候选区的长宽均大于零件所在矩形的长宽，则表示此计算候选区一定能拼入此零件，那么就对计算候选区根据适应度排序，那么适应度小于这个 “长宽均大于零件所在矩形的长宽的计算候选区” 的计算候选区，就不做计算

Step2 : 删除与拼入零件相交的候选区，并根据剩余的候选区刷新计算候选区。此处需注意不用刷新所有的计算候选区，只需要刷新与拼入零件相交的计算候选区即可

step3 : 判断零件是否还有剩余，如果有剩余则转step1,否则算法结束

## 步骤三.返回结果

返回排版方案和未拼入的零件